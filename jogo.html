<html>
  <body>
    <canvas id="folha" width="600" height="500"></canvas>

    <script>
      window.onload = function() {
        setInterval(principal,1000/30);
      }
       iniciar();
      function iniciar(){
           posicaoBolaX = posicaoBolaY = 10;
           velocidadeBolaY = velocidadeBolaX = 10;
            posicaoJogador1 = 30;
            posicaoJogador2 = 30;
            pontuacaoJ2 = pontuacaoJ1 = 0;
            folhaDesenho = document.getElementById("folha");
            area_desenho = folhaDesenho.getContext("2d");
            larguraCampo=600;
            alturaCampo=500;
            larguraLinha=5;
            larguraBola=10;
            alturaRaquete=100;
            espessuraRaquete=11;
            efeitoRaquete = 0.3;
            velocidadeJ2 = 5;
            velocidadeJ1 = 5 ;



        folhaDesenho.addEventListener('mousemove',function(e){
          posicaoJogador1= e.clientY - alturaRaquete/2
        })
      }

      function desenhar(){

                area_desenho.fillStyle = '#286047';
                area_desenho.fillRect(0,0,larguraCampo,alturaCampo);
                area_desenho.fillStyle = '#FFFFFF';

                //Linha
                area_desenho.fillRect((larguraCampo/2)-(larguraLinha/2),0,larguraLinha,alturaCampo);

                //Carinha esquerdo J1
                area_desenho.fillRect(0,posicaoJogador1,espessuraRaquete,alturaRaquete);

                //Carinha Direito J2
                area_desenho.fillRect(larguraCampo-larguraLinha,posicaoJogador2,espessuraRaquete,alturaRaquete);

                  // Bola
                  area_desenho.fillRect(posicaoBolaX-larguraBola/2 ,posicaoBolaY-larguraBola/2,larguraBola,larguraBola);

                  // Escrever a pontuação do jogo
                  area_desenho.fillText("Humano - " + pontuacaoJ1 + " pontos",100,100);
                  area_desenho.fillText("Computador - " + pontuacaoJ2 + " pontos",400,100);

      }
      function continuar(){
        posicaoBolaX = larguraCampo/2;
        posicaoBolaY = alturaCampo/2;
        velocidadeBolaX = -velocidadeBolaX;
        velocidadeBolaY = 3;
      }
      function calcular(){

        if (pontuacaoJ1%2==0 && pontuacaoJ1!=0){
          //velocidadeBolaY=velocidadeBolaY+2;
          //velocidadeBolaX=velocidadeBolaX+2;
          velocidadeJ2=velocidadeJ2*1.2;
          //velocidadeJ1=velocidadeJ1+2;
        }

          posicaoBolaX = posicaoBolaX + velocidadeBolaX;
          posicaoBolaY = posicaoBolaY + velocidadeBolaY;

          // verifica lateral superior
          if(posicaoBolaY<0 && velocidadeBolaY <0){
          velocidadeBolaY=-velocidadeBolaY;
          }

          // verifica lateral inferior
          if(posicaoBolaY > alturaCampo && velocidadeBolaY > 0){
          velocidadeBolaY=-velocidadeBolaY;
          }

          // verifica se J2 fez um ponto
          if (posicaoBolaX < 0) {
          if (posicaoBolaY > posicaoJogador1 && posicaoBolaY < posicaoJogador1 + alturaRaquete) {
            velocidadeBolaX=-velocidadeBolaX;
            var diferencaY = posicaoBolaY - (posicaoJogador1+alturaRaquete/2);
            velocidadeBolaY = diferencaY*efeitoRaquete;
          } else {
              pontuacaoJ2 = pontuacaoJ2 + 1;
              continuar();
            }
          }

          if (posicaoBolaX > larguraCampo){
            if (posicaoBolaY > posicaoJogador2 && posicaoBolaY < posicaoJogador2 + alturaRaquete) {
              velocidadeBolaX = -velocidadeBolaX;
              var diferencaY = posicaoBolaY - (posicaoJogador2 + alturaRaquete/2);
              velocidadeBolaY=diferencaY*efeitoRaquete;
            } else {
          pontuacaoJ1 = pontuacaoJ1 + 1;
          continuar();
              }
          }
          //
          if(posicaoJogador2+alturaRaquete/2 < posicaoBolaY){
            posicaoJogador2 = posicaoJogador2 + velocidadeJ2;
          } else {
              posicaoJogador2 = posicaoJogador2 - velocidadeJ2;
          }
      }
      function principal(){
        calcular();
        desenhar();
    }
    </script>
  </body>
</html>
